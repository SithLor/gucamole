/*!************************************************************************
 **
 ** Copyright (c) 2022-2023 Don Johnston, Inc. All rights reserved.
 **
 **************************************************************************/
!function(){"use strict";!function(){function e(e,n,o,i){if(!e||e instanceof Array&&e.length<=0)return o();i=i||0,e instanceof Array?t(e,0,n,o,i):a(e,Object.keys(e),0,n,o,i)}function t(e,a,n,o,i){if(e.length<=a)return o();2===n.length?n(e[a],(c=>{c?setTimeout(o,i,c):setTimeout(t,i,e,a+1,n,o,i)})):n(a,e[a],(c=>{c?setTimeout(o,i,c):setTimeout(t,i,e,a+1,n,o,i)}))}function a(e,t,n,o,i,c){if(t.length<=n)return i();2===o.length?o(e[t[n]],(s=>{s?setTimeout(i,c,s):setTimeout(a,c,e,t,n+1,o,i,c)})):o(t[n],e[t[n]],(s=>{s?setTimeout(i,c,s):setTimeout(a,c,e,t,n+1,o,i,c)}))}function n(e,t,a){const n=t&&void 0!==t.repeats?t.repeats:1;if(n<=0)return a();const i="forward"===e?"ArrowRight":"ArrowLeft",s="forward"===e?39:37;o(c([{type:"keydown",key:i,keyCode:s,repeats:n},{type:"keyup",key:i,keyCode:s}]),!0,0,((e,t,a)=>{}),a)}function o(t,a,n,o,i){const{activeElement:c}=document;if(a)e(t,((e,t,a)=>{const n=!c.dispatchEvent(t);o&&o(e,t,n)?a(!0):a(!1)}),i,n);else{let e=!1;const a=function(e){},n=function(e){};c.addEventListener("blur",a,!0),c.addEventListener("focus",n,!0);for(let a=0;!e&&a<t.length;a++){const n=t[a],i=!c.dispatchEvent(n);if(o&&o(a,n,i)){e=!0;break}}c.removeEventListener("blur",a,!0),c.removeEventListener("focus",n,!0),i(e)}}function i(e){const t=new Event(e.type,{bubbles:!0,cancelable:!0}),a="keypress"===e.type;return t.__isDjiSyntheticEvent=!0,e.hasOwnProperty("id")&&(t.__id=e.id),t.altKey=Boolean(e.altKey),t.ctrlKey=Boolean(e.ctrlKey),t.metaKey=Boolean(e.metaKey),t.shiftKey=Boolean(e.shiftKey),t.key=e.key,t.keyCode=e.keyCode,t.code=e.key,t.charCode=a?e.keyCode:0,t.which=e.keyCode,t.location=0,t.repeat=Boolean(e.repeat),t.isComposing=!1,t}function c(e){const t=[];for(let a=0;a<e.length;a++){const n=e[a],o=n.repeats||1,c=!n.hasOwnProperty("repeat");for(let e=0;e<o;e++)c&&(n.repeat=Boolean(e>0)),t.push(i(n))}return t}document.documentElement.addEventListener("com.donjohnston.cwu.dispatch",(t=>{if(t.preventDefault(),t.stopPropagation(),t.detail)try{"keyboardEvents"===t.detail.command?(a=t.detail.params,s=()=>{if(t.detail.callbackMessage){const e=new CustomEvent(t.detail.callbackMessage,{detail:{userData:t.detail.userData}});document.documentElement.dispatchEvent(e)}},e(a,((e,t,a)=>{o(function(e){const t=[],a=e.repeats||1,n=!e.hasOwnProperty("repeat");for(let o=0;o<a;o++)n&&(e.repeat=Boolean(o>0)),t.push(i(e));return t}(t),!1,0,((e,a,n)=>{if(t.callbackMessage){const a=new CustomEvent(t.callbackMessage,{detail:{index:e,cancelled:n,params:t}});document.documentElement.dispatchEvent(a)}}),a)}),(()=>{setTimeout(s,10)}))):"text"===t.detail.command?function(e,t){if(!e||e.length<=0||!document.activeElement)return t();const a=function(e){const t=[];for(let a=0;a<e.length;a++){const n=e.charCodeAt(a),o=e.charAt(a),i=o.toUpperCase()===o;let c;i&&(c=new Event("keydown",{bubbles:!0,cancelable:!0}),c.__isDjiSyntheticEvent=!0,c.altKey=!1,c.ctrlKey=!1,c.metaKey=!1,c.shiftKey=i,c.code="Shift",c.key="Shift",c.keyCode=16,c.which=16,c.location=0,c.repeat=!1,c.isComposing=!1),c=new Event("keydown",{bubbles:!0,cancelable:!0}),c.__isDjiSyntheticEvent=!0,c.altKey=!1,c.ctrlKey=!1,c.metaKey=!1,c.shiftKey=i,c.code="KeySynthetic",c.key=o,c.keyCode=n,c.which=n,c.location=0,c.repeat=!1,c.isComposing=!1,c=new Event("keypress",{bubbles:!0,cancelable:!0}),c.__isDjiSyntheticEvent=!0,c.__char=o,c.altKey=!1,c.ctrlKey=!1,c.metaKey=!1,c.shiftKey=i,c.key=o,c.keyCode=n,c.charCode=n,c.which=n,c.location=0,c.repeat=!1,c.isComposing=!1,t.push(c),c=new Event("textInput",{bubbles:!0,cancelable:!0}),c.__isDjiSyntheticEvent=!0,c.data=o,c.which=0,c.detail=0,c.repeat=!1,c.isComposing=!1,t.push(c),c=new Event("keyup",{bubbles:!0,cancelable:!0}),c.__isDjiSyntheticEvent=!0,c.altKey=!1,c.ctrlKey=!1,c.metaKey=!1,c.shiftKey=i,c.code="KeySynthetic",c.key=o,c.keyCode=n,c.which=n,c.location=0,c.repeat=!1,c.isComposing=!1,i&&(c=new Event("keyup",{bubbles:!0,cancelable:!0}),c.__isDjiSyntheticEvent=!0,c.altKey=!1,c.ctrlKey=!1,c.metaKey=!1,c.shiftKey=!1,c.code="Shift",c.key="Shift",c.keyCode=16,c.which=16,c.location=0,c.repeat=!1,c.isComposing=!1)}return t}(e);o(a,!0,5,((e,t,a)=>{!a&&t.__char&&document.execCommand("insertText",!1,t.__char)}),(()=>{setTimeout((()=>{const e=new Event("textInput",{bubbles:!0,cancelable:!0});e.__isDjiSyntheticEvent=!0,e.data="",e.which=0,e.detail=0,e.repeat=!1,e.isComposing=!1,document.activeElement.dispatchEvent(e),setTimeout(t,10)}),10)}))}(t.detail.params,(()=>{if(t.detail.callbackMessage){const e=new CustomEvent(t.detail.callbackMessage,{detail:{userData:t.detail.userData}});document.documentElement.dispatchEvent(e)}})):"deleteForward"===t.detail.command?function(e,t){const a=e&&void 0!==e.repeats?e.repeats:1;if(a<=0)return t();o(c([{id:1,type:"keydown",key:"Delete",keyCode:46,repeats:a},{type:"keyup",key:"Delete",keyCode:46}]),!0,0,((e,t,a)=>{a||1!==t.__id||document.execCommand("forwardDelete",!1,null)}),(()=>{setTimeout(t,10)}))}(t.detail.params,(()=>{if(t.detail.callbackMessage){const e=new CustomEvent(t.detail.callbackMessage,{detail:{userData:t.detail.userData}});document.documentElement.dispatchEvent(e)}})):"moveForward"===t.detail.command?n("forward",t.detail.params,(()=>{if(t.detail.callbackMessage){const e=new CustomEvent(t.detail.callbackMessage,{detail:{userData:t.detail.userData}});document.documentElement.dispatchEvent(e)}})):"moveBackward"===t.detail.command&&n("backward",t.detail.params,(()=>{if(t.detail.callbackMessage){const e=new CustomEvent(t.detail.callbackMessage,{detail:{userData:t.detail.userData}});document.documentElement.dispatchEvent(e)}}))}catch(e){}var a,s}),!0)}()}();
