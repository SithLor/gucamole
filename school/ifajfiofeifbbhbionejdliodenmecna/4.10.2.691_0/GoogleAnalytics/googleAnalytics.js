function GoogleAnalytics(){this.m_privacyMode=this.m_chromeExtentionAnalytics=this.m_apiKey=this.m_measurementId=null;this.m_debugViewEnabled=!1;return this}GoogleAnalytics.instance=null;GoogleAnalytics.prototype.__initialize=function(a,b){this.m_measurementId=a;this.m_apiKey=b;this.m_chromeExtentionAnalytics=new window.__ChromeAnalyticsGA4.ChromeExtensionAnalytics(this.m_measurementId,this.m_apiKey);this.m_chromeExtentionAnalytics.setDebugEnabled(!1)};
function __addEventListeners(){window.cwe.login.addEventListener("ga4-domain-license",a=>{GoogleAnalytics.instance.setDomainLicense({userEmail:a.detail.data.userEmail,domain:a.detail.data.domain,licenseType:a.detail.data.type,licenseName:a.detail.data.name,productCode:a.detail.data.productCode,productName:a.detail.data.productName,licenseStatus:a.detail.data.status,licenseStartDate:a.detail.data.startDate,licenseGuid:a.detail.data.guid})});window.cwe.login.addEventListener("ga4-send-event",a=>{a=
a.detail.data;GoogleAnalytics.instance.sendEvent(a.eventName,a.customProperties,a.defaultProperties,a.resetSessionId)});window.cwe.login.addEventListener("ga4-privacy-mode",a=>{GoogleAnalytics.instance.setPrivacyMode(a.detail.data)})}
GoogleAnalytics.initialize=function(a,b){if(null===GoogleAnalytics.instance)try{GoogleAnalytics.instance=new GoogleAnalytics,GoogleAnalytics.instance.__initialize(a,b),__addEventListeners()}catch(d){GoogleAnalytics.instance=null,Logger.instance.error("Google Analytics - cannot create instance!"),Logger.instance.error(d)}};GoogleAnalytics.prototype.setPrivacyMode=function(a){this.m_privacyMode!==a&&(this.m_privacyMode=a)};
GoogleAnalytics.prototype.setDebugViewEnabled=function(a){this.m_debugViewEnabled=a};GoogleAnalytics.prototype.setDomainLicense=async function(a){if(a){var b=window.__ChromeAnalyticsGA4.DomainLicense.fromUserEmail(a.userEmail);b.domain=a.domain;b.productCode=a.productCode;b.licenseGuid=a.licenseGuid;b.licenseType=a.licenseType;b.licenseName=a.licenseName;b.licenseStatus=a.licenseStatus;b.licenseStartDate=a.licenseStartDate;GoogleAnalytics.instance.m_chromeExtentionAnalytics.setDomainLicense(b)}else Logger.instance.error("Google Analytics - the license cannot be set!")};
GoogleAnalytics.prototype.prepareEvent=function(a,b,d){this.m_debugViewEnabled&&(b=b&&{debug_mode:!0,...b}||{debug_mode:!0});if(!b&&!d)return GoogleAnalyticsEvents[a];a=JSON.parse(JSON.stringify(GoogleAnalyticsEvents[a]));if(d)for(const [e,c]of Object.entries(d))a.params[e]=c;if(b){a.customProperties=a.customProperties||{};for(const [e,c]of Object.entries(b))a.customProperties[e]=c}return a};
GoogleAnalytics.prototype.sendEvent=async function(a,b,d,e){if(!this.m_privacyMode)try{const c=this.prepareEvent(a,b,d),f=new window.__ChromeAnalyticsGA4.AnalyticsEvent(c.eventName,c.params.category,c.params.feature,c.params.website||"");c.customProperties instanceof Object&&(f.customProperties=c.customProperties);GoogleAnalytics.instance.m_chromeExtentionAnalytics.pushEvent(f,e)}catch(c){Logger.instance.error("Google Analytics - error on pushing event."),Logger.instance.error(c)}};
window.dji=window.dji||{};window.dji.cwe=window.dji.cwe||{};window.dji.cwe.ga4=GoogleAnalytics;
