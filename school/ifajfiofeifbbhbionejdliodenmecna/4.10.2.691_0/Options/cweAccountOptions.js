window.dji=window.dji||{};
(function(d){function f(a){let b=$("#dji-cwu-activation-code").val().trim();g.test(b)?($("body").addClass("dji-cwu-working"),c.applyActivationCode(b,function(e){$("body").removeClass("dji-cwu-working");!e||e.error?(dji.ui.toast.show({message:c.CWEI18n.instance.getMessage("cwu_error_connect_educator")}),a(!1)):(dji.ui.toast.show({message:c.CWEI18n.instance.getMessage("cwu_activation_code")}),a(!0))})):(dji.ui.toast.show({message:c.CWEI18n.instance.getMessage("cwu_activation_code_invalid")}),a(!1))}
let c=null,g=/^[23456789abcdefghijkmnpqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ]{8,8}$/;d.initialize=function(a){let b=a.userInfo();c=a;$("#dji-cwu-user-name").find("span").text(b.name||b.email||b.username);"DAPI"!==b.provider.toUpperCase()&&"D:API"!==b.provider.toUpperCase()&&$("#dji-cwu-change-user-password").hide();if(a=(a=chrome.extension.getBackgroundPage())?a.CWESettingsInstance():null)a=a.features(),!a||a.allowSettings&&a.allowChangeSettings?$("#dji-cwu-connect-with-educator").removeClass("dji-cwu-disabled"):
$("#dji-cwu-connect-with-educator").addClass("dji-cwu-disabled")};d.showConnectToEducatorModalDlg=function(){dji.ui.modalDlg.showModalDlg("dji-cwu-connect-with-educator",{doneCallback:f})};d.showChangeUserPasswordModalDlg=function(){dji.ui.modalDlg.showModalDlg("dji-cwu-change-user-password")}})(window.dji.account=window.dji.account||{});
