window.jsdapi=window.jsdapi||{};
(function(g){function h(b){var c=window.jsdapi.url();b&&(c+="/"+b);return c}function k(b){var c=window.jsdapi.url()+"/account";b&&(c+="/"+b);return c}function e(b){if(b)try{b.apply(this,[].slice.call(arguments).splice(1))}catch(c){console.error(c)}}g.me=function(b){window.jsdapi.authorize(function(c){c?(c={responseType:"json",method:"GET",url:h("openid/me"),query:{access_token:c,ignoreGrantsGiven:!0,ignoreGrantsGivenBy:!0,ignoreProducts:!0,ignoreTags:!0,analytics:!0}},window.jsdapi.http.sendRequest(c,
function(a){if(!a||a.error)return e(b,a||{error:500});var d={checksum:a.me.checksum,name:a.me.name};a.me.email&&(d.email=a.me.email);a.me.anonymous&&(d.anonymous=a.me.anonymous);a.me.analytics&&(d.analytics=a.me.analytics);if(a.me.accounts)try{var f=JSON.parse(a.me.accounts);0<f.length&&(d.account=f[0],d.account.username&&(d.username=d.account.username),d.account.provider&&(d.provider=d.account.provider))}catch(l){console.error(l)}if(!d.account)return e(b,{error:500});delete d.account;e(b,d)})):e(b,
{error:401,message:"Authorization failed!"})})};g.applyActivationCode=function(b,c){window.jsdapi.authorize(function(a){if(a){var d=JSON.stringify(b);a={responseType:"json",method:"POST",url:k("applyActivationCode"),query:{access_token:a},contentType:"application/json",content:d};window.jsdapi.http.sendRequest(a,function(f){e(c,f)})}else e(c,{error:401,message:"Authorization failed!"})})}})(window.jsdapi.account=window.jsdapi.account||{});
